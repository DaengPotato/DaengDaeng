package com.daengdaeng.domain.pet.service;import com.daengdaeng.domain.pet.domain.MbtiQuestion;import com.daengdaeng.domain.pet.dto.response.MbtiResponse;import com.daengdaeng.domain.pet.repository.MbtiQuestionRepository;import lombok.RequiredArgsConstructor;import lombok.extern.slf4j.Slf4j;import org.springframework.security.core.Authentication;import org.springframework.security.core.context.SecurityContextHolder;import org.springframework.security.core.userdetails.UserDetails;import org.springframework.stereotype.Service;import javax.transaction.Transactional;import java.util.List;import java.util.stream.Collectors;@Slf4j@Service@Transactional@RequiredArgsConstructorpublic class MbtiServiceImpl implements MbtiService{    private final MbtiQuestionRepository mbtiQuestionRepository;    @Override    public List<MbtiResponse> findMbtiQuestion() {        List<MbtiQuestion> mbtiQuestionList = mbtiQuestionRepository.findAll();        List<MbtiResponse> mbtiResponseList = mbtiQuestionList.stream()                .map(mbtiQuestion -> {                    return MbtiResponse.builder()                            .questionId(mbtiQuestion.getQuestionId())                            .question(mbtiQuestion.getQuestion())                            .answerA(mbtiQuestion.getAnswerA())                            .answerB(mbtiQuestion.getAnswerB())                            .build();                })                .collect(Collectors.toList());        return mbtiResponseList;    }    /**     * 스프링 시큐리티 인증을 통과하여 저장된 회원의 인증 객체에서 이메일 추출     * @return String : 이메일     */    private String getCurrentEmail() {        Authentication authentication = SecurityContextHolder.getContext().getAuthentication();        UserDetails principal = (UserDetails) authentication.getPrincipal();        log.info("principal : {}", principal.getUsername());        return principal.getUsername();    }}